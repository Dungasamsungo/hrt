<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="https://www.thymeleaf.org"
    xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity3">

<head>
    <title>List</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>

     
		
 <script>
         lsUser = []
         function listAllUser() {

            const xhttp = new XMLHttpRequest();
            xhttp.open("GET", `/user/`);
            xhttp.send();
            xhttp.onload = function () {
                lsUser = JSON.parse(this.responseText);
                out = "";
                for (const i in lsUser) {
                    console.log(lsUser[i])
                    u = lsUser[i]
                    out += `<tr onclick='activate(${i})'><td>${u.name}</td>
                                                        <td>${u.status}</td>
                                                        <td>${u.location}</td>
                                                        <td>${u.proposedTime}</td>
                                                        <td>${u.actualStartTime}</td>
                                                        <td>${u.endTime}</td>
                                                        <td>${u.exitTime}</td>
                            </tr>`;
                }
            document.getElementById("tbody").innerHTML = out;
            }
        }



                       
		
			var myVar = setInterval(myTimer, 1000);
			function myTimer() {
				var d = new Date();
				document.getElementById("refresh-timer").innerHTML = d.getDate()+'/'+(d.getMonth()+1)+'/'+d.getFullYear()+' '+ d.toLocaleTimeString();

				//var tabela = localStorage.getItem('tbody');

				document.getElementById("tbody").innerHTML = tabela;
			}
			documento.myTimer();
		   

</script>



<div class="container mt-3">
    <div class="d-flex justify-content-start">
        <img src = "Logo.png" height="100px">
    </div>

   <!-- <div class="d-flex justify-content-end">
        <a href="manager.html" class="btn btn-secondary" role="button" >Add New Patient</a>
    </div> <br> -->
    
    <form th:action="@{/logout}" method="post" class="d-flex justify-content-end">
   <input type="submit" value="Sign Out" /></form>

   
    <div>
    <h3> Regional Hospital Taguatinga | Secretaria de Estado de Sa√∫de do
        Distrito Federal | Pacients At The Surgical Center - <span id="refresh-timer"></span></h3>
    </div>

    <table class="table table-hover" style="cursor: pointer;">
        <thead class="table-success">
            <tr>
                <th width= "40%"   >Name</th>
                <th width= "30%" >Status</th>
                <th width= "30%" >Location</th>
                <th width= "30%" >Proposed Start Time</th>
                <th width= "30%">Actual Start Time</th>
                <th width= "30%">Surgery End Time</th>
                <th width= "30%">Exit Time</th>
            </tr>
        </thead>
        <tbody id="tbody">

        </tbody>
    </table>
</div>

<script>listAllUser();</script>
</body>
</html>